# MLflow实验跟踪说明
## 1. 实验概述
共跟踪2个实验，均基于v2清洗后数据集（DVC数据版本：`dvc_data_hash: abc123`），模型类型为LogisticRegression，任务为二分类（预测用户是否转化）。

## 2. 实验详情
| 实验名称                | 超参数差异                          | 测试集准确率 | 测试集F1分数 | 备注                  |
|-------------------------|-----------------------------------|--------------|--------------|-----------------------|
| 基线模型                | C=1.0, solver=lbfgs, 无类别权重    | 0.82         | 0.78         | 默认参数，未处理类别不平衡 |
| 改进模型（生产用）      | C=0.1, solver=liblinear, 类别权重balanced | 0.85         | 0.86         | 调优后F1提升8%，处理类别不平衡 |

## 3. 生产模型选择：改进模型
选择理由：
1. **核心指标更优**：项目目标是“准确识别高转化风险用户”，数据存在类别不平衡（正样本占比30%），F1分数能同时兼顾精确率和召回率，改进模型F1=0.86显著高于基线模型的0.78；
2. **鲁棒性更强**：通过`class_weight="balanced"`解决类别不平衡，避免模型偏向多数类；
3. **部署效率高**：`solver=liblinear`计算速度快，适合API接口低延迟调用。

## 4. 优化指标说明（F1分数）
选择F1分数作为核心优化指标的原因：
- 业务场景中，“漏判正样本”（将转化用户预测为非转化）会导致营销资源浪费，“误判负样本”（将非转化用户预测为转化）会导致用户体验下降，需同时平衡精确率（减少误判）和召回率（减少漏判）；
- 准确率受类别不平衡影响较大（多数类占比高时，准确率易虚高），F1分数更能反映模型真实性能。

## 5. 如何复现实验
```bash
# 1. 拉取v2数据
git checkout e4f5g6h data/processed.dvc
dvc pull data/processed.dvc

# 2. 运行训练脚本
cd ml
python train.py

# 3. 查看实验结果
mlflow ui  # 访问http://127.0.0.1:5000


### 3. 完善`ml/registry/current_model.md`（记录生产模型）
```markdown
# 生产环境当前使用模型
## 模型信息
- 模型来源：MLflow实验「改进模型-LogisticRegression调优」
- MLflow Run ID：789abcde（可通过`mlflow ui`在实验中查看）
- 模型路径：mlruns/820475391756355105/b68a05d830a2499a89cfe79d28fae901/artifacts/model（与main.py中模型路径一致）
- 对应数据版本：DVC v2（data/processed.dvc，Git Commit：e4f5g6h）
- 部署时间：2025-10-27

## 模型性能
- 测试集F1分数：0.86
- 测试集准确率：0.85
- 适用场景：用户转化预测API接口（/predict）